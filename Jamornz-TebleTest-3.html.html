<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏Ç‡πà‡∏á ‡∏™‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå 7&9 EP 13</title>

  <!-- 1Ô∏è‚É£  CSS (‡∏ò‡∏µ‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°) -->
  <style>
    body{
      font-family:Arial,Helvetica,sans-serif;
      background:#1e1e1e;color:#fff;margin:0;padding:20px 10px
    }
    h1, h2{margin:0;text-align:center}
    h1{margin-bottom:4px;font-size:1.4rem}
    h2{font-weight:400;margin-bottom:24px;font-size:0.95rem;line-height:1.4}
    #controls{display:flex;justify-content:center;margin-bottom:16px}
    select{padding:6px 10px;font-size:1rem;border-radius:6px;border:1px solid #555;background:#2b2b2b;color:#fff}

    table{
      width:100%;max-width:1200px;margin:36px auto;border-collapse:collapse;
      background:#2a2a2a;border-radius:10px;overflow:hidden;
      box-shadow:0 0 10px rgba(0,0,0,.8);table-layout:fixed
    }
    col.col-time  {width:7.69%}
    col.col-match {width:7.69%}
    col.col-team  {width:38.46%}
    col.col-vs    {width:7.69%}

    th,td{padding:12px 8px;border:1px solid #444;text-align:center;overflow-wrap:break-word}
    th{background:#3a3a3a}
    thead tr:first-child th{background:#444;font-size:1.15em}
    td.vs{background:#111;font-weight:bold;white-space:nowrap}
    tr:nth-child(even){background:#2f2f2f}
    tr:nth-child(odd){background:#262626}

    @media(max-width:768px){
      th,td{padding:8px 6px;font-size:13px}
    }
  </style>
</head>

<body>
  <!-- 2Ô∏è‚É£  ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
  <h1>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏™‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå 7&9 EP 13</h1>
  <h2>üìÖ ‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏ó‡∏µ‡πà 22 ‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô 2568<br>‚öΩ ‡∏ì ‡∏™‡∏ô‡∏≤‡∏° SML ‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏¢‡∏≤‡∏á &amp; ‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏ú‡πà‡∏ß‡∏á‡∏®‡πå ‚Ä¢ üìå ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å</h2>

  <!-- 3Ô∏è‚É£  ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ô‡∏≤‡∏° -->
  <div id="controls">
    <label style="margin-right:8px">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ô‡∏≤‡∏°:</label>
    <select id="fieldSelect"></select>
  </div>

  <!-- 4Ô∏è‚É£  ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
  <div id="content"></div>

  <!-- 5Ô∏è‚É£  PapaParse ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏¢‡∏Å CSV ‡πÅ‡∏ö‡∏ö‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏°‡∏µ , ‡∏´‡∏£‡∏∑‡∏≠ " ‡∏Å‡πá‡πÑ‡∏°‡πà‡∏û‡∏±‡∏á) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- 6Ô∏è‚É£  JavaScript ‡∏´‡∏•‡∏±‡∏Å -->
  <script>
    // üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå CSV (‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQxQVDSQZxKIkP2v60gYVw5tbmRbmSwKnHGXF2g7HXUj9FYHZl1d6_JJ8wH-3ArPgT8Us5DJHibP56d/pub?output=csv";

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î & ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    async function loadSchedule() {
      const res   = await fetch(CSV_URL);
      const csv   = await res.text();
      const data  = Papa.parse(csv, {header:true, skipEmptyLines:true}).data;

      // üëâ ‡∏´‡∏≤ label3 (‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ô‡∏≤‡∏°) ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
      const fields = [...new Set(data.map(r => r.label3.trim()).filter(Boolean))];

      // ‡πÄ‡∏ï‡∏¥‡∏° drop-down
      const sel = document.getElementById("fieldSelect");
      sel.innerHTML = fields.map(f => `<option value="${f}">${f}</option>`).join("");
      sel.onchange  = () => renderTable(data, sel.value);

      // render ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏Å)
      renderTable(data, fields[0]);
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á / ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï HTML ‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    function renderTable(rows, selectedField) {
      const content = document.getElementById("content");
      content.innerHTML = "";               // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°

      let currentRound = null;              // ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏≠‡∏ö
      let table, tbody;

      rows.forEach(r => {
        if (r.label3.trim() !== selectedField) return;   // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ô‡∏≤‡∏°

        const round = r.label1.trim();                   // ‡∏£‡∏≠‡∏ö (‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á)

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏≠‡∏ö ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
        if (round !== currentRound) {
          currentRound = round;

          table = document.createElement("table");
          table.innerHTML = `
            <colgroup>
              <col class="col-time">
              <col class="col-match">
              <col class="col-team">
              <col class="col-vs">
              <col class="col-team">
            </colgroup>
            <thead>
              <tr><th colspan="5">üèÜ ${currentRound}</th></tr>
              <tr>
                <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                <th>‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà</th>
                <th>‡∏ó‡∏µ‡∏° A</th>
                <th>Score</th>
                <th>‡∏ó‡∏µ‡∏° B</th>
              </tr>
            </thead>
          `;
          tbody = document.createElement("tbody");
          table.appendChild(tbody);
          content.appendChild(table);
        }

        // ‡πÅ‡∏õ‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
        const htmlRow = `
          <tr>
            <td>${r.Time || ""}</td>
            <td>${r.label2 || ""}</td>
            <td>${r.TeamA  || ""}</td>
            <td class="vs">${r.Score || "VS"}</td>
            <td>${r.TeamB  || ""}</td>
          </tr>
        `;
        tbody.insertAdjacentHTML("beforeend", htmlRow);
      });

      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ô‡∏≤‡∏°‡∏ô‡∏±‡πâ‡∏ô
      if (!content.children.length) {
        content.innerHTML = `<p style="text-align:center">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${selectedField}</p>`;
      }
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    loadSchedule();
  </script>
</body>
</html>
