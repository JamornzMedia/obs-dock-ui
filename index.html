<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Jamornz Dock UI License Panel</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #121212;
      color: #fff;
      text-align: center;
      margin: 0; padding: 0;
      min-height: 100vh;
    }
    .container {
      background: #222;
      border-radius: 18px;
      padding: 2em;
      max-width: 600px;
      margin: 2em auto;
      box-shadow: 0 0 32px #0007;
    }
    .status-inactive {
      color: #ff5050;
      font-weight: bold;
      margin-bottom: 0.7em;
    }
    .status-active {
      color: #24d159;
      font-weight: bold;
      margin-bottom: 0.7em;
    }
    .login-btn {
      padding: 0.7em 2.5em;
      border-radius: 10px;
      border: none;
      background: #ffd700;
      color: #222;
      font-size: 1.15em;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 1em;
      margin-top: 0.7em;
      transition: background 0.2s;
    }
    .login-btn:active { background: #fffcae; }
    .license-info {
      background: #161f27;
      border-radius: 10px;
      margin: 1.3em 0;
      padding: 1em;
      text-align: left;
      font-size: 1.08em;
      display: inline-block;
      min-width: 320px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2em;
      margin-bottom: 1.5em;
      background: #181c21;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      padding: 0.9em 0.4em;
      text-align: center;
      border-bottom: 1px solid #222;
      font-size: 1.02em;
    }
    th {
      background: #2a3442;
      color: #ffd700;
    }
    tr:last-child td { border-bottom: none; }
    .copy-btn {
      background: #ffd700;
      color: #222;
      font-weight: bold;
      padding: 0.55em 1.5em;
      border-radius: 7px;
      border: none;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.18s;
    }
    .copy-btn:disabled {
      background: #aaa;
      color: #666;
      cursor: not-allowed;
      opacity: 0.5;
    }
    .copy-ok {
      color: #24d159;
      font-size: 0.96em;
      margin-top: 0.1em;
    }
    .instructions {
      background: #202732;
      border-radius: 10px;
      padding: 1.2em;
      margin-top: 1.2em;
      text-align: left;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      font-size: 1.04em;
    }
    @media (max-width: 600px) {
      .container, .instructions { max-width: 98vw; padding: 1em; }
      table { font-size: 0.97em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Jamornz Dock UI License Panel</h2>
    <div id="status-text" class="status-inactive">
      ยังไม่ได้เข้าสู่ระบบ (Inactive) <br>
      <span style="font-size:0.98em; color:#aaa;">Not logged in</span>
    </div>
    <button id="login-btn" class="login-btn">เข้าสู่ระบบ (Login)</button>
    <div id="license-info" class="license-info" style="display:none;"></div>
    <table>
      <thead>
        <tr>
          <th>UI รายการ<br><span style="font-weight:normal; color:#aaa;">UI Name</span></th>
          <th>คัดลอกลิงก์ OBS Dock<br><span style="font-weight:normal; color:#aaa;">Copy Dock UI Link</span></th>
        </tr>
      </thead>
      <tbody id="ui-table">
        <!-- auto-generate rows -->
      </tbody>
    </table>
    <div id="copy-result"></div>
  </div>
  <div class="instructions">
    <b>วิธีใช้งานกับ OBS Dock</b><br>
    1. เปิดโปรแกรม OBS Studio<br>
    2. ที่เมนูด้านบน เลือก <b>Docks &gt; Custom Browser Docks...</b><br>
    3. ตั้งชื่อ Dock ที่ต้องการ แล้ว <b>คัดลอกลิงก์</b> จากปุ่มด้านบน<br>
    4. นำลิงก์ไปวางในช่อง URL ของ OBS แล้วกด Apply<br>
    5. ที่เมนูด้านบน เลือก Docks แล้วเลือกชื่อ Dock ที่สร้างไว้ <br>
    <br>
    <b>How to use with OBS Dock</b><br>
    1. Open OBS Studio.<br>
    2. In the top menu, select <b>Docks &gt; Custom Browser Docks...</b><br>
    3. Enter your desired Dock name, then <b>copy the link</b> from the button above.<br>
    4. Paste the link into the URL field in OBS and click Apply.<br>
    5. In the top menu, select Docks, then choose the Dock name you created.<br>
    <br>
  </div>
  <script>
    // ======= CONFIG =======
    // รายการ UI ทั้งหมดที่ต้องการโชว์ (เพิ่ม/แก้ไขได้ในอนาคต)
    const uiList = [
      {
        nameTH: "แผงควบคุมการแข่งขันฟุตบอล",
        nameEN: "Football Control Panel",
        url: "Football-Control-Panel.html"
      },
      {
        nameTH: "แผงควบคุมจุดโทษฟุตบอล",
        nameEN: "Penalty Shootout",
        url: "Penalty-Shootout.html"
      }
    ];

    // จำลอง License สำหรับตัวอย่าง (ในของจริงจะต้อง fetch จาก server หรือ Supabase)
    let license = {
      typeTH: "ทดลองฟรี 15 วัน",
      typeEN: "Free Trial 15 Days",
      expiresAt: addDays(new Date(), 15), // ปรับเป็น addDays(new Date(), 15) สำหรับทดลองฟรี
    };
    let isActive = false;

    // ======= DOM Ready =======
    document.addEventListener('DOMContentLoaded', () => {
      renderTable();
      document.getElementById('login-btn').onclick = doLogin;
    });

    function doLogin() {
      if (isActive) return;
      // ปกติจะทำกระบวนการเชื่อมต่อ license/hardware id ที่นี่
      isActive = true;
      document.getElementById('status-text').innerHTML = `
        <span class="status-active">ใช้งานอยู่ (Active)</span><br>
        <span style="font-size:0.98em; color:#aaa;">License Active</span>
      `;
      document.getElementById('login-btn').disabled = true;
      showLicenseInfo();
      enableCopyBtns();
    }

    function showLicenseInfo() {
      let now = new Date();
      let expires = new Date(license.expiresAt);
      let msLeft = expires - now;
      let days = Math.floor(msLeft / (1000 * 60 * 60 * 24));
      let hours = Math.floor((msLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      let endDateStr = expires.toLocaleString('th-TH', {year:'numeric',month:'2-digit',day:'2-digit', hour:'2-digit',minute:'2-digit'});
      let endDateStrEN = expires.toLocaleString('en-US', {year:'numeric',month:'2-digit',day:'2-digit', hour:'2-digit',minute:'2-digit'});

      document.getElementById('license-info').style.display = '';
      document.getElementById('license-info').innerHTML = `
        <b>ประเภท License:</b> ${license.typeTH} <span style="color:#aaa;">(${license.typeEN})</span><br>
        <b>วันหมดอายุ:</b> ${endDateStr} <span style="color:#aaa;">(${endDateStrEN})</span><br>
        <b>เหลือเวลา:</b> ${days} วัน ${hours} ชม.<span style="color:#aaa;"> (${days} days, ${hours} hours left)</span>
      `;
    }

    function renderTable() {
      const table = document.getElementById('ui-table');
      table.innerHTML = '';
      uiList.forEach((ui, idx) => {
        let tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${ui.nameTH}<br><span style="color:#aaa;font-size:0.97em;">${ui.nameEN}</span></td>
          <td>
            <button class="copy-btn" data-url="${location.origin}/${encodeURIComponent(ui.url)}" id="copy-btn-${idx}" disabled>คัดลอกลิงก์<br><span style="font-size:0.95em;font-weight:normal;">Copy Link</span></button>
          </td>
        `;
        table.appendChild(tr);
      });
      // set event for copy btn
      uiList.forEach((ui, idx) => {
        document.getElementById('copy-btn-' + idx).onclick = function() {
          copyToClipboard(this.getAttribute('data-url'), idx);
        }
      });
    }

    function enableCopyBtns() {
      uiList.forEach((ui, idx) => {
        document.getElementById('copy-btn-' + idx).disabled = false;
      });
    }

    function copyToClipboard(text, idx) {
      navigator.clipboard.writeText(text).then(() => {
        showCopyOk(idx);
      });
    }

    function showCopyOk(idx) {
      // แสดงสถานะว่าคัดลอกสำเร็จ
      const old = document.getElementById('copy-ok-msg-' + idx);
      if (old) old.remove();
      const btn = document.getElementById('copy-btn-' + idx);
      let okMsg = document.createElement('div');
      okMsg.className = 'copy-ok';
      okMsg.id = 'copy-ok-msg-' + idx;
      okMsg.innerText = 'คัดลอกแล้ว! (Copied)';
      btn.parentNode.appendChild(okMsg);
      setTimeout(()=>{ okMsg.remove(); },1500);
    }

    // Utility: เพิ่มวันจากวันที่ปัจจุบัน
    function addDays(date, days) {
      let result = new Date(date);
      result.setDate(result.getDate() + days);
      return result;
    }
  </script>
</body>
</html>
