<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <title>L3 Control Center - JamornzMedia</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Using native WebSocket instead of obs-websocket-js -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div class="app-header">
        <div class="logo-header-main">LOWER THIRD</div>
        <div class="logo-header-sub">OBS DOCK CONTROLLER</div>
    </div>

    <div class="status-bar">
        <div>
            OBS: <span id="obs-status-dot" class="status-indicator"></span>
            <span id="obs-status-text">Disconnect</span>
        </div>
        <div id="data-count" style="color:#666;">No Data</div>
    </div>

    <div class="container">
        <!-- Dynamic Cards Container -->
        <div id="cards-container" class="cards-container">
            <!-- Cards will be generated here -->
        </div>
    </div>

    <!-- IMPORT BAR (Collapsible) -->
    <div id="import-bar" class="import-bar">
        <div class="import-bar-header" onclick="toggleImportBar()">
            <div class="import-bar-title">
                <span class="icon">üìÇ</span>
                <span>Import Excel Data</span>
            </div>
            <div style="display:flex; align-items:center; gap:10px;">
                <span id="import-status" class="import-status empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                <span class="toggle-arrow">‚ñ≤</span>
            </div>
        </div>
        <div class="import-bar-content">
            <!-- Image Folder Setting -->
            <div style="margin-bottom:10px;">
                <label
                    style="display:flex; align-items:center; gap:5px; font-size:10px; color:#888; margin-bottom:4px;">
                    üñºÔ∏è Image Folder:
                </label>
                <input type="text" id="image-folder-input" placeholder="C:\Images\" style="width:100%; font-size:10px;"
                    onchange="saveImageFolder(this.value)">
                <div style="font-size:8px; color:#555; margin-top:2px;">
                    ‡πÉ‡∏™‡πà‡πÅ‡∏Ñ‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Excel (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•) ‡πÄ‡∏ä‡πà‡∏ô player1
                </div>
            </div>
            <input type="file" id="fileInput" accept=".xlsx, .xls, .csv" style="display:none;">
            <div id="drop-zone" class="drop-zone">
                <div class="drop-zone-icon">üìÅ</div>
                <div><b>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</b> ‡∏´‡∏£‡∏∑‡∏≠ ‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
                <div style="font-size:9px; color:#666; margin-top:5px;">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: .xlsx, .xls, .csv</div>
                <div style="font-size:9px; color:#555; margin-top:3px;">Columns: ID, name, LabelName1, LabelName2,
                    LabelName3, image</div>
            </div>
            <!-- Settings Buttons -->
            <div style="display:flex; gap:5px; margin-top:10px;">
                <button class="btn-outline" onclick="openModal('modal-help')" style="flex:0;">‚ùì</button>
                <button class="btn-settings" onclick="openModal('modal-settings')" style="flex:1;">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    Cards</button>
                <button class="btn-outline" style="color:#ffca28; border-color:#ffca28; flex:0;"
                    onclick="openModal('modal-sponsor')">üéÅ</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="modal-settings" class="modal-overlay" onclick="closeModal(event, 'modal-settings')">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null, 'modal-settings')">&times;</button>
            <h2>‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Cards</h2>

            <div id="settings-list" class="settings-list">
                <!-- Settings items will be generated here -->
            </div>

            <div class="add-card-form">
                <h4>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Card ‡πÉ‡∏´‡∏°‡πà</h4>
                <div class="form-row">
                    <div class="input-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠ Card</label>
                        <input type="text" id="new-card-name" placeholder="‡πÄ‡∏ä‡πà‡∏ô Player Info">
                    </div>
                    <div class="input-group">
                        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                        <select id="new-card-type">
                            <option value="single">Single (1 ‡∏Ñ‡∏ô)</option>
                            <option value="double">Double (2 ‡∏Ñ‡∏ô)</option>
                        </select>
                    </div>
                </div>
                <button class="btn-add" id="btn-add-card">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Card</button>
            </div>

            <div style="text-align:center; font-size:9px; color:#666; margin-top:12px;">
                ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 10 Cards
            </div>
        </div>
    </div>

    <!-- EDIT CARD MODAL -->
    <div id="modal-edit" class="modal-overlay" onclick="closeModal(event, 'modal-edit')">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null, 'modal-edit')">&times;</button>
            <h2>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Card</h2>

            <div class="edit-form">
                <input type="hidden" id="edit-card-index">
                <div class="input-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠ Card</label>
                    <input type="text" id="edit-card-name">
                </div>
                <div class="input-group">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                    <select id="edit-card-type">
                        <option value="single">Single (1 ‡∏Ñ‡∏ô)</option>
                        <option value="double">Double (2 ‡∏Ñ‡∏ô)</option>
                    </select>
                </div>
                <div class="btn-row">
                    <button class="btn-cancel" onclick="closeModal(null, 'modal-edit')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn-save" onclick="saveCardEdit()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- SPONSOR MODAL -->
    <div id="modal-sponsor" class="modal-overlay" onclick="closeModal(event, 'modal-sponsor')">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null, 'modal-sponsor')">&times;</button>
            <h2 style="color:#ffca28;">Support Developer</h2>
            <div class="sponsor-grid">
                <div class="sponsor-item">
                    <span style="color:#fff; font-weight:bold;">Thai Bank / PromptPay</span>
                    <div class="qr-box"><img
                            src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://easydonate.app/Jamornz"
                            alt="QR"></div>
                    <a href="https://easydonate.app/Jamornz" target="_blank">easydonate.app/Jamornz</a>
                </div>
            </div>
            <div style="margin-top:15px; font-size:10px; color:#666;">Developed by <b>JamornzMedia</b></div>
        </div>
    </div>

    <!-- HELP MODAL -->
    <div id="modal-help" class="modal-overlay" onclick="closeModal(event, 'modal-help')">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null, 'modal-help')">&times;</button>
            <h2 style="color:#00aaff;">üìñ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
            <div style="font-size:11px; color:#ccc; text-align:left;">
                <p><b>1. Import Excel</b><br>
                    ‡∏Å‡∏î‡πÅ‡∏ñ‡∏ö "üìÇ Import Excel Data" ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå<br>
                    Columns: <code style="color:#888;">ID, name, LabelName1, LabelName2, LabelName3, image</code>
                </p>
                <p><b>2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Cards</b><br>
                    ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Cards" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Cards<br>
                    - <span style="color:#4ade80;">Single</span>: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 1 ‡∏Ñ‡∏ô<br>
                    - <span style="color:#fbbf24;">Double</span>: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 2 ‡∏Ñ‡∏ô (Home/Away)
                </p>
                <p><b>3. ‡∏™‡∏£‡πâ‡∏≤‡∏á OBS Sources</b><br>
                    ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‚öôÔ∏è ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ Card<br>
                    ‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ Group (‡∏°‡∏µ ‚ûï) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Sources ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥<br>
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Text ‡πÅ‡∏•‡∏∞ Image Sources ‡πÉ‡∏ô Scene ‡∏Ç‡∏≠‡∏á OBS
                </p>
                <p><b>4. ‡∏ä‡∏∑‡πà‡∏≠ Source ‡πÉ‡∏ô OBS</b><br>
                    <u>Single Card:</u><br>
                    <code style="color:#4ade80;">T_Name_1</code>, <code style="color:#4ade80;">T_Label1_1</code>, <code
                        style="color:#4ade80;">I_Avatar_1</code><br>
                    <u>Double Card:</u><br>
                    <code style="color:#4ade80;">T_Name_Home_2</code>, <code style="color:#4ade80;">T_Name_Away_2</code>
                </p>
                <p><b>5. Group Sources ‡πÉ‡∏ô OBS</b><br>
                    ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á Sources ‡πÅ‡∏•‡πâ‡∏ß:<br>
                    1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Sources ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Å‡∏î Ctrl ‡∏Ñ‡πâ‡∏≤‡∏á)<br>
                    2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤ ‚Üí Group Selected Items<br>
                    3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Group ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á ‡πÄ‡∏ä‡πà‡∏ô <code style="color:#4ade80;">G_LowerThird_1</code>
                </p>
            </div>
        </div>
    </div>

    <!-- CARD SETTINGS MODAL -->
    <div id="modal-card-settings" class="modal-overlay" onclick="closeModal(event, 'modal-card-settings')">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null, 'modal-card-settings')">&times;</button>
            <h2 id="card-settings-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Card</h2>

            <div id="card-settings-content">
                <!-- Source names will be generated here -->
            </div>

            <div style="margin-top:12px; border-top:1px solid #333; padding-top:10px;">
                <div style="font-size:10px; color:#888; margin-bottom:6px;">üìä ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Dropdown:</div>
                <div id="column-visibility-toggles" style="display:flex; flex-wrap:wrap; gap:6px;">
                    <!-- Column toggles will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- CONFIRM CREATE SOURCE MODAL -->
    <div id="modal-confirm-create" class="modal-overlay" onclick="closeModal(event, 'modal-confirm-create')">
        <div class="modal" style="max-width:300px;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal(null, 'modal-confirm-create')">&times;</button>
            <h2 style="font-size:13px;">üîß ‡∏™‡∏£‡πâ‡∏≤‡∏á OBS Source</h2>
            <div id="confirm-create-content" style="font-size:11px; color:#ccc; margin-bottom:12px;">
                <!-- Content will be generated -->
            </div>
            <div class="btn-row">
                <button class="btn-cancel" onclick="closeModal(null, 'modal-confirm-create')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-save" id="btn-confirm-create">‚úì ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏¢</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>

</html>